"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[831],{47166:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var l,i=n(71406),c=n(90031),o=n(4224),a=n(67294);function s(){return a.createElement(i.Ho,null,a.createElement(r,null))}function r(){const{getAccessTokenSilently:e}=(0,c.g)(),[t,n]=(0,a.useState)(l.AUTHORIZING),[i,s]=(0,a.useState)(),{gtagEvent:r}=(0,o.u)();switch((0,a.useEffect)((()=>{(async()=>{const t=await e(),i=new URLSearchParams(window.location.search),c=i.get("code"),o=i.get("state"),a=await fetch("https://us-west-2.prod.aws.tidbcloud.com/api/v1/serverless-credits-campaign/oauth/tidbcloud/callback",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({code:c,state:o,redirect_uri:location.origin+"/open-source-heroes/tidbcloud/oauth/callback/"})});a.ok?(r("connect_tidb_cloud_succeed",{}),n(l.AUTHORIZED),setTimeout((()=>{window.close()}),1500)):(r("connect_tidb_cloud_failed",{}),n(l.FAILED),s(await a.json()))})()}),[]),t){case l.AUTHORIZING:return a.createElement("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",gap:8,alignItems:"center",justifyContent:"center"}},a.createElement("h3",null,"Authorizing"),a.createElement("div",null,"Please do not close this window."));case l.AUTHORIZED:return a.createElement("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",gap:8,alignItems:"center",justifyContent:"center"}},a.createElement("h3",null,"Authorized"),a.createElement("div",null,"This window will close in seconds. Go back to ",a.createElement("span",{onClick:()=>window.close(),style:{textDecoration:"underline"}},"OSSInsight"),"."));case l.FAILED:return a.createElement("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",gap:8,alignItems:"center",justifyContent:"center"}},a.createElement("h3",null,(null==i?void 0:i.error)??"Authorization failed"),a.createElement("div",null,(null==i?void 0:i.message)??"Unknown error"))}}!function(e){e[e.AUTHORIZING=0]="AUTHORIZING",e[e.AUTHORIZED=1]="AUTHORIZED",e[e.FAILED=2]="FAILED"}(l||(l={}))}}]);